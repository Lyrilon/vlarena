<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼æ¨¡å‹æ€§èƒ½åˆ†æåº”ç”¨ (Geminié©±åŠ¨)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        .loader {
            border-top-color: #3498db;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">LIBERO Benchmark æ¨¡å‹æ€§èƒ½æ¯”è¾ƒ</h1>
            <p class="mt-2 text-lg text-gray-600">æ’è¡Œæ¦œ</p>
        </header>

        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-500">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th scope="col" class="px-6 py-3">æ¨¡å‹ (Method)</th>
                            <th scope="col" class="px-6 py-3 text-center">SPATIAL</th>
                            <th scope="col" class="px-6 py-3 text-center">OBJECT</th>
                            <th scope="col" class="px-6 py-3 text-center">GOAL</th>
                            <th scope="col" class="px-6 py-3 text-center">LONG</th>
                            <th scope="col" class="px-6 py-3 text-center">Average</th>
                            <th scope="col" class="px-6 py-3 text-center">åŸæ–‡é“¾æ¥</th>
                            <th scope="col" class="px-6 py-3 text-center">æ“ä½œ (Actions)</th>
                        </tr>
                    </thead>
                    <tbody id="model-table-body">
                        </tbody>
                </table>
            </div>
             <div class="p-4 bg-gray-50 border-t border-gray-200">
                <p class="text-xs text-gray-600">
                    <sup>a</sup> <span class="italic">OpenVLA åŸºçº¿æ¨¡å‹åœ¨ä¸åŒæ¥æºä¸­çš„ SPATIAL åˆ†æ•°åˆ†åˆ«ä¸º 84.7% å’Œ 84.9%ï¼Œè¡¨ä¸­é‡‡ç”¨äº†å‰è€…ã€‚</span>
                </p>
                <div class="mt-3 pt-3 border-t border-gray-200 text-sm text-gray-700">
                    <h4 class="font-semibold inline-block mr-4">å›¾æ³¨:</h4>
                    <span class="mr-6 inline-flex items-center"><strong class="text-blue-600 font-bold">è“è‰²å­—ä½“</strong>: è¯¥åˆ—æœ€ä½³æ€§èƒ½</span>
                    <span class="mr-6 inline-flex items-center"><strong class="text-sky-500 font-bold">æµ…è“è‰²å­—ä½“</strong>: è¯¥åˆ—æ¬¡ä½³æ€§èƒ½</span>
                    <span class="inline-flex items-center"><strong class="text-red-600 font-medium">çº¢è‰²å­—ä½“</strong>: ç”¨æˆ·å¤ç°ç»“æœ</span>
                </div>
            </div>
        </div>
        
        <footer class="text-center mt-8">
            <p class="text-sm text-gray-500">ç”¨äºå±•ç¤º</p>
        </footer>
    </div>

    <div id="notes-modal" class="fixed inset-0 z-50 items-center justify-center hidden p-4">
        <div class="modal-backdrop fixed inset-0 transition-opacity"></div>
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl mx-auto z-10 transform transition-all scale-95 opacity-0">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-xl font-semibold text-gray-900" id="modal-title">é˜…è¯»ç¬”è®°</h3>
            </div>
            <div class="p-6">
                <div id="modal-content" class="text-base leading-relaxed text-gray-700" style="min-height: 150px;">
                    <div id="loader" class="flex justify-center items-center h-full">
                        <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div>
                    </div>
                    </div>
            </div>
            <div class="px-6 py-4 bg-gray-50 rounded-b-lg text-right">
                <button id="close-modal-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                    å…³é—­
                </button>
            </div>
        </div>
    </div>

    <script>
    const modelData = [
        { name: "Diffusion Policy (scratch) [5, 17]", spatial: "78.3%", object: "92.5%", goal: "68.3%", long: "50.5%", average: "72.4%", link: "#" },
        { name: "Octo (fine-tuned) [49, 62]", spatial: "78.9%", object: "85.7%", goal: "84.6%", long: "51.1%", average: "75.1%", link: "#" },
        { name: "OpenVLA (fine-tuned) [23, 42]", spatial: "84.7%", object: "88.4%", goal: "79.2%", long: "53.7%", average: "76.5%", link: "#" },
        { name: "SpatialVLA [59]", spatial: "88.2%", object: "89.9%", goal: "78.6%", long: "55.5%", average: "78.1%", link: "#" },
        { name: "CoT-VLA [75]", spatial: "87.5%", object: "91.6%", goal: "87.6%", long: "69.0%", average: "81.1%", link: "#" },
        { name: "DIT Policy (fine-tuned) [13]", spatial: "84.2%", object: "96.3%", goal: "85.4%", long: "63.8%", average: "82.4%", link: "#" },
        { name: "Ï€â‚€ + FAST (fine-tuned) [38, 58]", spatial: "96.4%", object: "96.8%", goal: "88.6%", long: "60.2%", average: "85.5%", link: "#" },
        { name: "OpenVLA (fine-tuned) + PD&AC", spatial: "91.3%", object: "92.7%", goal: "90.5%", long: "86.5%", average: "90.2%", link: "#" },
        { name: "UniVLA (å¤ç°)", spatial: "94.8%", object: "97.2%", goal: "90.6%", long: "92.4%", average: "93.8%", link: "#" },
        { name: "Ï€â‚€ (fine-tuned) [3]", spatial: "96.8%", object: "98.8%", goal: "95.8%", long: "85.2%", average: "94.2%", link: "#" },
        { name: "OpenVLA (fine-tuned) + PD&AC, Cont-Diffusion", spatial: "96.9%", object: "98.1%", goal: "95.5%", long: "91.1%", average: "95.4%", link: "#" },
        { name: "UniVLA", spatial: "95.4%", object: "98.8%", goal: "93.6%", long: "94.0%", average: "95.5%", link: "#" },
        { name: "OpenVLA-OFT (OpenVLA (fine-tuned) + PD&AC, Cont-L1) (ours)", spatial: "97.6%", object: "98.4%", goal: "97.9%", long: "94.5%", average: "97.1%", link: "#" }
    ];

        const tableBody = document.getElementById('model-table-body');
        const modal = document.getElementById('notes-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const loader = document.getElementById('loader');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const modalBackdrop = modal.querySelector('.modal-backdrop');

        // Function to find the top 2 values in each column, handling ties.
        function getColumnTopValues(data) {
            const topValues = {};
            const keys = ['spatial', 'object', 'goal', 'long', 'average'];

            keys.forEach(key => {
                const uniqueValues = [...new Set(data.map(row => parseFloat(row[key])))];
                uniqueValues.sort((a, b) => b - a);
                
                topValues[key] = {
                    top1: uniqueValues.length > 0 ? uniqueValues[0] : -1,
                    top2: uniqueValues.length > 1 ? uniqueValues[1] : -1
                };
            });
            return topValues;
        }

        const topValues = getColumnTopValues(modelData);

        // Function to return the correct CSS class for highlighting
        function getHighlightClass(key, value) {
            const numericValue = parseFloat(value);
            if (numericValue === topValues[key].top1) {
                return 'font-bold text-blue-600'; // 1st place: Blue
            }
            if (numericValue === topValues[key].top2) {
                return 'font-bold text-sky-500'; // 2nd place: Light Blue (Sky)
            }
            return ''; // No highlight
        }
        
        // Populate table
        modelData.sort((a, b) => parseFloat(b.average) - parseFloat(a.average)); // Sort by average score descending
        
        modelData.forEach(model => {
            const row = document.createElement('tr');
            const isReproduction = model.name === "UniVLA (å¤ç°)";
            
            let baseClasses = 'bg-white border-b hover:bg-gray-50';
            if (isReproduction) {
                // Apply red color and medium font weight to the entire row for reproduction entry
                baseClasses += ' text-red-600 font-medium';
            }
            row.className = baseClasses;
            
            // Conditionally set the class for the name cell.
            // If it's the reproduction, let it inherit the row's red color by not adding a specific color class.
            // Otherwise, use the default gray text color.
            const nameClass = isReproduction ? '' : 'text-gray-900';
            
            // Conditionally set the class for the button
            const buttonClass = isReproduction 
                ? 'text-red-600 hover:text-red-800' 
                : 'text-blue-600 hover:text-blue-800';

            row.innerHTML = `
                <td class="px-6 py-4 font-medium ${nameClass} whitespace-nowrap">${model.name}</td>
                <td class="px-6 py-4 text-center ${getHighlightClass('spatial', model.spatial)}">${model.spatial}</td>
                <td class="px-6 py-4 text-center ${getHighlightClass('object', model.object)}">${model.object}</td>
                <td class="px-6 py-4 text-center ${getHighlightClass('goal', model.goal)}">${model.goal}</td>
                <td class="px-6 py-4 text-center ${getHighlightClass('long', model.long)}">${model.long}</td>
                <td class="px-6 py-4 text-center ${getHighlightClass('average', model.average)}">${model.average}</td>
                <td class="px-6 py-4 text-center">
                    <a href="${model.link}" target="_blank" class="text-indigo-600 hover:text-indigo-800 underline">
                        é“¾æ¥
                    </a>
                </td>
                <td class="px-6 py-4 text-center">
                    <button class="view-notes-btn font-medium ${buttonClass}" data-model="${model.name}">
                        ğŸ“– é˜…è¯»ç¬”è®°
                    </button>
                </td>
            `;
            tableBody.appendChild(row);
        });
        
        // Modal logic
        function showModal() {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => {
                modal.querySelector('.z-10').classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function hideModal() {
            modal.querySelector('.z-10').classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 200);
        }

        closeModalBtn.addEventListener('click', hideModal);
        modalBackdrop.addEventListener('click', hideModal);

        // Gemini API call logic
        async function getReadingNotes(modelName) {
            showModal();
            modalTitle.textContent = `å…³äº â€œ${modelName}â€ çš„é˜…è¯»ç¬”è®°`;
            loader.style.display = 'flex';
            modalContent.innerHTML = ''; 
            modalContent.appendChild(loader);

            const prompt = `è¯·ä¸ºAIæ¨¡å‹ '${modelName}' ç”Ÿæˆä¸€ä»½è¯¦ç»†çš„ä¸­æ–‡é˜…è¯»ç¬”è®°ã€‚ç¬”è®°åº”åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š1. **æ ¸å¿ƒæ€æƒ³**ï¼šç”¨ä¸€ä¸¤å¥è¯æ¦‚æ‹¬æ¨¡å‹çš„å…³é”®åˆ›æ–°ç‚¹ã€‚ 2. **æ¶æ„è§£æ**ï¼šç®€è¦æè¿°æ¨¡å‹çš„ä¸»è¦ç»„æˆéƒ¨åˆ†å’Œå·¥ä½œæµç¨‹ã€‚å¦‚æœåç§°ä¸­åŒ…å«å¤šä¸ªç»„ä»¶ï¼ˆå¦‚ A + Bï¼‰ï¼Œè¯·åˆ†åˆ«è§£é‡Šå®ƒä»¬çš„ä½œç”¨ä»¥åŠå¦‚ä½•ååŒå·¥ä½œã€‚ 3. **å…³é”®è´¡çŒ®**ï¼šåˆ—å‡ºè¯¥æ¨¡å‹å¸¦æ¥çš„ä¸»è¦æŠ€æœ¯çªç ´æˆ–åº”ç”¨ä¼˜åŠ¿ã€‚ 4. **æ½œåœ¨åº”ç”¨**ï¼šåˆ†æè¯¥æ¨¡å‹é€‚åˆåœ¨å“ªäº›å…·ä½“åœºæ™¯ä¸‹ä½¿ç”¨ã€‚è¯·ä½¿ç”¨æ¸…æ™°çš„æ ‡é¢˜å’Œåˆ—è¡¨ï¼Œè®©ç¬”è®°ç»“æ„åˆ†æ˜ï¼Œæ˜“äºç†è§£ã€‚`;
            
            // Replace with your actual API key
            const apiKey = "YOUR_API_KEY";
            if (apiKey === "YOUR_API_KEY") {
                 loader.style.display = 'none';
                 modalContent.innerHTML = `<strong>æ³¨æ„ï¼š</strong>è¯·åœ¨ä»£ç ä¸­æ›¿æ¢ "YOUR_API_KEY" ä¸ºæ‚¨è‡ªå·±çš„ Gemini API å¯†é’¥æ‰èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚`;
                 return;
            }

            let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${apiKey}`;
            
            try {
                let response;
                let retries = 3;
                let delay = 1000;
                for (let i = 0; i < retries; i++) {
                    response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (response.ok) break;
                    await new Promise(res => setTimeout(res, delay));
                    delay *= 2;
                }

                if (!response.ok) {
                    throw new Error(`API è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    loader.style.display = 'none';
                    modalContent.innerHTML = text.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                } else {
                    throw new Error("æœªèƒ½ä»APIè·å–æœ‰æ•ˆç¬”è®°ã€‚");
                }
            } catch (error) {
                console.error("ç”Ÿæˆé˜…è¯»ç¬”è®°æ—¶å‡ºé”™:", error);
                loader.style.display = 'none';
                modalContent.textContent = `æŠ±æ­‰ï¼Œæ— æ³•åŠ è½½é˜…è¯»ç¬”è®°ã€‚è¯·ç¨åå†è¯•ã€‚\né”™è¯¯: ${error.message}`;
            }
        }

        document.querySelectorAll('.view-notes-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const modelName = e.target.getAttribute('data-model');
                getReadingNotes(modelName);
            });
        });

    </script>
</body>
</html>